{% load i18n djicons %}

<!-- Header -->
<div class="side-sheet-header">
    <h3 class="sheet-title">{% trans "Add Product" %}</h3>
    <button class="sheet-close" @click="closePanel()">
        {% icon "close-outline" %}
    </button>
</div>

<!-- Body -->
<div class="side-sheet-content">
    <form id="add-product-form"
          hx-post="{% url 'inventory:product_add' %}"
          hx-target="#datatable-body"
          hx-swap="innerHTML"
          hx-encoding="multipart/form-data"
          @htmx:after-request="closePanel()"
          class="flex flex-col gap-4 p-6">
        {% csrf_token %}

        {% if error %}
        <div class="callout callout-error">
            <div class="callout-content">
                <span class="callout-text">{{ error }}</span>
            </div>
        </div>
        {% endif %}

        <!-- Name -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Name" %}</label>
            <input type="text" name="name" class="input input-sm w-full"
                   placeholder="{% trans 'Product name' %}" required>
        </div>

        <!-- SKU -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "SKU" %}</label>
            <input type="text" name="sku" class="input input-sm w-full"
                   placeholder="{% trans 'SKU code' %}" required>
        </div>

        <!-- Type -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Type" %}</label>
            <select name="product_type" class="select select-sm w-full">
                <option value="physical">{% trans "Physical Product" %}</option>
                <option value="service">{% trans "Service" %}</option>
            </select>
        </div>

        <!-- Price & Cost -->
        <div class="grid grid-cols-2 gap-3">
            <div>
                <label class="text-sm font-medium mb-1 block">{% trans "Price" %}</label>
                <input type="number" name="price" class="input input-sm w-full"
                       step="0.01" min="0" placeholder="0.00" required>
            </div>
            <div>
                <label class="text-sm font-medium mb-1 block">{% trans "Cost" %}</label>
                <input type="number" name="cost" class="input input-sm w-full"
                       step="0.01" min="0" placeholder="0.00" value="0">
            </div>
        </div>

        <!-- Stock & Threshold -->
        <div class="grid grid-cols-2 gap-3">
            <div>
                <label class="text-sm font-medium mb-1 block">{% trans "Stock" %}</label>
                <input type="number" name="stock" class="input input-sm w-full"
                       min="0" placeholder="0" value="0">
            </div>
            <div>
                <label class="text-sm font-medium mb-1 block">{% trans "Low Stock" %}</label>
                <input type="number" name="low_stock_threshold" class="input input-sm w-full"
                       min="0" placeholder="10" value="10">
            </div>
        </div>

        <!-- EAN-13 -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "EAN-13" %}</label>
            <input type="text" name="ean13" class="input input-sm w-full"
                   placeholder="{% trans 'Optional barcode' %}" maxlength="13">
        </div>

        <!-- Categories -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Categories" %}</label>
            <select name="categories" class="select select-sm w-full" multiple>
                {% for cat in categories_list %}
                <option value="{{ cat.id }}">{{ cat.name }}</option>
                {% endfor %}
            </select>
        </div>

        <!-- Tax Class -->
        {% if tax_classes %}
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Tax Class" %}</label>
            <select name="tax_class" class="select select-sm w-full">
                <option value="">{% trans "Default" %}</option>
                {% for tc in tax_classes %}
                <option value="{{ tc.id }}">{{ tc.name }} ({{ tc.rate }}%)</option>
                {% endfor %}
            </select>
        </div>
        {% endif %}

        <!-- Description -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Description" %}</label>
            <textarea name="description" class="textarea textarea-sm w-full" rows="3"
                      placeholder="{% trans 'Product description' %}"></textarea>
        </div>

        <!-- Image -->
        <div>
            <label class="text-sm font-medium mb-1 block">{% trans "Image" %}</label>
            <input type="file" name="image" accept="image/*" class="input input-sm w-full">
        </div>
    </form>
</div>

<!-- Footer -->
<div class="side-sheet-footer">
    <div class="flex justify-end gap-2">
        <button type="button" class="btn btn-ghost btn-sm" @click="closePanel()">
            {% trans "Cancel" %}
        </button>
        <button type="submit" form="add-product-form" class="btn btn-sm color-primary">
            {% icon "add-outline" %}
            {% trans "Add Product" %}
        </button>
    </div>
</div>
